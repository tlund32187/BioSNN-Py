<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BioSNN | Synapse Dashboard</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app">
      <header class="app-header">
        <div>
          <p class="eyebrow">BioSNN ? Synapse Dashboard</p>
          <h1>Spiking Neural Network ? Connection Monitor</h1>
          <p class="subhead">
            Visualizing edges, delays, and spike flow. No learning yet ? just raw
            network dynamics.
          </p>
          <div class="status">
            <span class="status-dot" id="dataStatusDot"></span>
            <span id="dataStatus">Demo data</span>
            <a id="dataLink" class="status-link" href="#" target="_blank" rel="noreferrer">Open run folder</a>
          </div>
        </div>
        <div class="header-side">
          <div class="header-metrics">
            <div class="metric">
              <span class="label">FPS</span>
              <span class="value" id="fps">--</span>
            </div>
            <div class="metric">
              <span class="label">Active Edges</span>
              <span class="value" id="activeEdges">--</span>
            </div>
            <div class="metric">
              <span class="label">Spike Rate</span>
              <span class="value" id="spikeRate">--</span>
            </div>
          </div>
          <section class="run-panel">
            <h2>Run</h2>
            <div class="run-controls">
              <label>Demo
                <select id="runDemoSelect">
                  <option value="network">Network</option>
                  <option value="vision">Vision</option>
                  <option value="pruning_sparse">Pruning Sparse</option>
                  <option value="neurogenesis_sparse">Neurogenesis Sparse</option>
                  <option value="propagation_impulse">Propagation Impulse</option>
                  <option value="delay_impulse">Delay Impulse</option>
                  <option value="learning_gate">Learning Gate</option>
                  <option value="dopamine_plasticity">Dopamine Plasticity</option>
                  <option value="logic_curriculum">Logic Curriculum</option>
                  <option value="logic_and">Logic AND</option>
                  <option value="logic_or">Logic OR</option>
                  <option value="logic_xor">Logic XOR</option>
                  <option value="logic_nand">Logic NAND</option>
                  <option value="logic_nor">Logic NOR</option>
                  <option value="logic_xnor">Logic XNOR</option>
                </select>
              </label>
              <label>Steps
                <input id="runStepsInput" type="number" min="1" value="200" />
              </label>
              <label>Device
                <select id="runDeviceSelect">
                  <option value="cpu">cpu</option>
                  <option value="cuda">cuda</option>
                </select>
              </label>
              <label>Layout
                <select id="runFusedLayoutSelect">
                  <option value="auto">auto</option>
                  <option value="coo">coo</option>
                  <option value="csr">csr</option>
                </select>
              </label>
              <label>Ring
                <select id="runRingStrategySelect">
                  <option value="dense">dense</option>
                  <option value="event_bucketed">event_bucketed</option>
                </select>
              </label>
              <label class="checkbox-inline">
                <input id="runLearningToggle" type="checkbox" />
                Learning
              </label>
              <label class="checkbox-inline">
                <input id="runMonitorsToggle" type="checkbox" checked />
                Monitors
              </label>
            </div>
            <details class="run-advanced" id="runAdvancedSection">
              <summary>Advanced Biology</summary>
              <div class="run-controls run-controls-advanced">
                <label id="runLogicBackendWrap">Logic backend
                  <select id="runLogicBackendSelect">
                    <option value="harness">harness</option>
                    <option value="engine">engine</option>
                  </select>
                </label>
                <label class="checkbox-inline">
                  <input id="runExplorationEnabledToggle" type="checkbox" />
                  Exploration
                </label>
                <label>epsilon_start
                  <input id="runEpsilonStartInput" type="number" min="0" max="1" step="0.01" value="0.2" />
                </label>
                <label>epsilon_end
                  <input id="runEpsilonEndInput" type="number" min="0" max="1" step="0.01" value="0.01" />
                </label>
                <label>epsilon_decay_trials
                  <input id="runEpsilonDecayTrialsInput" type="number" min="1" step="1" value="3000" />
                </label>
                <label>tie_break
                  <select id="runTieBreakSelect">
                    <option value="random_among_max">random_among_max</option>
                    <option value="alternate">alternate</option>
                    <option value="prefer_last">prefer_last</option>
                  </select>
                </label>
                <label>reward_delivery_steps
                  <input id="runRewardDeliveryStepsInput" type="number" min="0" max="5" step="1" value="2" />
                </label>
                <label class="checkbox-inline">
                  <input id="runAdvancedSynapseEnabledToggle" type="checkbox" />
                  Advanced synapse
                </label>
                <label class="checkbox-inline">
                  <input id="runAdvancedSynapseConductanceToggle" type="checkbox" />
                  conductance_mode
                </label>
                <label class="checkbox-inline">
                  <input id="runAdvancedSynapseNmdaBlockToggle" type="checkbox" />
                  nmda_block
                </label>
                <label class="checkbox-inline">
                  <input id="runAdvancedSynapseStpToggle" type="checkbox" />
                  stp_enabled
                </label>
                <label>Receptor mode
                  <select id="runReceptorModeSelect">
                    <option value="exc_only">exc_only</option>
                    <option value="ei_ampa_nmda_gabaa">ei_ampa_nmda_gabaa</option>
                    <option value="ei_ampa_nmda_gabaa_gabab">ei_ampa_nmda_gabaa_gabab</option>
                  </select>
                </label>
                <label class="checkbox-inline">
                  <input id="runModulatorToggle" type="checkbox" />
                  Modulators
                </label>
                <label>Modulator field
                  <select id="runModulatorFieldTypeSelect">
                    <option value="global_scalar">global_scalar</option>
                    <option value="grid_diffusion_2d">grid_diffusion_2d</option>
                  </select>
                </label>
                <label>Modulator kinds
                  <select id="runModulatorKindsSelect" multiple size="4">
                    <option value="dopamine">DA</option>
                    <option value="acetylcholine">ACh</option>
                    <option value="noradrenaline">NA</option>
                    <option value="serotonin">5HT</option>
                  </select>
                </label>
                <label class="checkbox-inline">
                  <input id="runWrapperEnabledToggle" type="checkbox" />
                  Wrapper
                </label>
                <label>wrapper ach_lr_gain
                  <input id="runWrapperAchGainInput" type="number" step="0.01" value="0.0" />
                </label>
                <label>wrapper ne_lr_gain
                  <input id="runWrapperNeGainInput" type="number" step="0.01" value="0.0" />
                </label>
                <label>wrapper ht_extra_weight_decay
                  <input id="runWrapperHtDecayInput" type="number" min="0" step="0.01" value="0.0" />
                </label>
                <label class="checkbox-inline">
                  <input id="runExcitabilityEnabledToggle" type="checkbox" />
                  Excitability modulation
                </label>
                <label>excitability ach_gain
                  <input id="runExcitabilityAchGainInput" type="number" step="0.01" value="0.0" />
                </label>
                <label>excitability ne_gain
                  <input id="runExcitabilityNeGainInput" type="number" step="0.01" value="0.0" />
                </label>
                <label>excitability ht_gain
                  <input id="runExcitabilityHtGainInput" type="number" step="0.01" value="0.0" />
                </label>
                <label class="checkbox-inline">
                  <input id="runHomeostasisEnabledToggle" type="checkbox" />
                  Homeostasis
                </label>
                <label>alpha
                  <input id="runHomeostasisAlphaInput" type="number" min="0.0001" max="1" step="0.0001" value="0.01" />
                </label>
                <label>eta
                  <input id="runHomeostasisEtaInput" type="number" min="0" step="0.0001" value="0.001" />
                </label>
                <label>r_target
                  <input id="runHomeostasisTargetInput" type="number" min="0" step="0.0001" value="0.05" />
                </label>
                <label>clamp_min
                  <input id="runHomeostasisClampMinInput" type="number" min="0" step="0.0001" value="0.0" />
                </label>
                <label>clamp_max
                  <input id="runHomeostasisClampMaxInput" type="number" min="0" step="0.0001" value="0.05" />
                </label>
                <label>scope
                  <select id="runHomeostasisScopeSelect">
                    <option value="per_population">per_population</option>
                    <option value="per_neuron">per_neuron</option>
                  </select>
                </label>
                <label class="checkbox-inline">
                  <input id="runPruningEnabledToggle" type="checkbox" />
                  Pruning
                </label>
                <label class="checkbox-inline">
                  <input id="runNeurogenesisEnabledToggle" type="checkbox" />
                  Neurogenesis
                </label>
              </div>
            </details>
            <div class="run-actions">
              <button id="runStartButton" type="button">Start Run</button>
              <button id="runStopButton" type="button">Stop</button>
              <span id="runStateText">State: unknown</span>
            </div>
          </section>
          <section class="feature-panel">
            <h2>Feature Checklist</h2>
            <ul id="runFeatureList"></ul>
          </section>
        </div>
      </header>

      <main class="grid">
        <section class="card card-network">
          <div class="card-header">
            <h2>Neural Network</h2>
            <div class="header-actions">
              <div class="view-toggle">
                <span>View</span>
                <select id="networkViewSelect">
                  <option value="neurons">Neurons</option>
                  <option value="populations">Populations</option>
                </select>
              </div>
              <div class="control-row neuron-controls" id="neuronControls">
                <label>Mode
                  <select id="neuronViewMode">
                    <option value="auto">Auto</option>
                    <option value="all">Show all</option>
                    <option value="sample">Sample</option>
                  </select>
                </label>
                <label>Max/Pop
                  <input id="neuronMaxPerPop" type="range" min="8" max="256" value="64" step="1" />
                  <span id="neuronMaxPerPopValue">64</span>
                </label>
                <label>Sampling
                  <select id="neuronSampleMode">
                    <option value="evenlySpaced">Evenly spaced</option>
                    <option value="firstK">First K</option>
                  </select>
                </label>
                <label>Layout
                  <select id="neuronLayoutMode">
                    <option value="layered">Layered</option>
                    <option value="spatial">Spatial</option>
                  </select>
                </label>
                <label>
                  <input id="edgeOpacityByDistance" type="checkbox" checked />
                  Edge opacity by distance
                </label>
                <label>
                  <input id="showDelayTooltip" type="checkbox" checked />
                  Show delay in tooltip
                </label>
                <span id="neuronClampBadge" class="chip warn hidden">Clamped to 512</span>
              </div>
              <span class="chip">Topology + weights</span>
            </div>
          </div>
          <canvas id="networkCanvas"></canvas>
          <div id="networkTooltip" class="network-tooltip"></div>
          <div class="legend">
            <span><i class="dot dot-input"></i> Input</span>
            <span><i class="dot dot-hidden"></i> Hidden</span>
            <span><i class="dot dot-output"></i> Output</span>
            <span><i class="dot dot-excite"></i> Excit.</span>
            <span><i class="dot dot-inhib"></i> Inhib.</span>
            <span><i class="dot dot-glif"></i> GLIF</span>
            <span><i class="dot dot-adex"></i> AdEx</span>
            <span><i class="dot dot-unknown"></i> Other</span>
            <span id="legendLocality"><i class="dot dot-locality"></i> Opacity ~ locality (short = bright)</span>
            <span id="legendDelay"><i class="dot dot-delay"></i> delay shown in tooltip</span>
          </div>
          <div id="neuronSampleInfo" class="neuron-sample-info"></div>
        </section>

        <section class="card card-raster">
          <div class="card-header">
            <h2>Spike Raster Plot</h2>
            <div class="header-actions">
              <div class="control-row">
                <label>Stride <input id="rasterStride" type="number" value="1" min="1" /></label>
                <label>Window <input id="rasterWindow" type="number" value="200" min="10" /></label>
                <label>Max pts <input id="rasterMaxPoints" type="number" value="200000" min="1000" /></label>
              </div>
              <span class="chip">Events</span>
            </div>
          </div>
          <canvas id="rasterCanvas"></canvas>
        </section>

        <section class="card card-accuracy">
          <div class="card-header">
            <h2>Training Accuracy</h2>
            <div class="header-actions">
              <div class="control-row">
                <label>Smooth <input id="smoothWindow" type="number" value="5" min="1" /></label>
              </div>
              <span class="chip muted">Metrics</span>
            </div>
          </div>
          <canvas id="accuracyCanvas"></canvas>
          <div class="accuracy-footer">
            <span>Train: <strong id="trainAccLatest">--</strong></span>
            <span>Eval: <strong id="evalAccLatest">--</strong></span>
            <span>Loss: <strong id="lossLatest">--</strong></span>
          </div>
        </section>

        <section class="card card-heatmap" data-title="Input ? Hidden">
          <div class="card-header">
            <h2>Weight Matrix</h2>
            <div class="header-actions">
              <div class="control-row">
                <label>Proj <select id="weightProjectionSelect"></select></label>
                <label>Step <select id="weightStepSelect"></select></label>
                <label>Clamp <input id="weightClampMin" type="number" value="-1" step="0.1" />
                  <input id="weightClampMax" type="number" value="1" step="0.1" /></label>
                <label>Max dim <input id="weightMaxDim" type="number" value="64" min="8" /></label>
              </div>
              <span class="chip">Weights</span>
            </div>
          </div>
          <canvas id="heatmapInput"></canvas>
        </section>

        <section class="card card-heatmap" data-title="Weight Matrix (Secondary)">
          <div class="card-header">
            <div>
              <h2>Weight Matrix (Secondary)</h2>
              <p class="subhead" id="weightProjectionLabel2">--</p>
            </div>
            <div class="header-actions">
              <div class="control-row">
                <label>Proj <select id="weightProjectionSelect2"></select></label>
              </div>
              <span class="chip">Weights</span>
            </div>
          </div>
          <canvas id="heatmapOutput"></canvas>
        </section>

        <section class="card card-bars">
          <div class="card-header">
            <h2>Spike Rates (Per-pop)</h2>
            <span class="chip">Per population</span>
          </div>
          <canvas id="rateCanvas"></canvas>
        </section>

        <section class="card card-bars">
          <div class="card-header">
            <h2>Weight Dist.</h2>
            <span class="chip">Synapse edges</span>
          </div>
          <canvas id="weightCanvas"></canvas>
        </section>

        <section class="card card-state">
          <div class="card-header">
            <h2>State Space (PCA)</h2>
            <span class="chip">Projection</span>
          </div>
          <canvas id="stateCanvas"></canvas>
        </section>

        <section class="card card-metrics">
          <div class="card-header">
            <h2>Learning Metrics</h2>
            <span class="chip muted">Read-only</span>
          </div>
          <ul class="metric-list" id="metricList"></ul>
        </section>

        <section class="card card-task">
          <div class="card-header">
            <h2 id="taskTitle">Demo Task</h2>
            <span class="chip" id="taskChip">Run summary</span>
          </div>
          <div class="task-body">
            <p class="task-summary" id="taskSummary">Waiting for run data...</p>
            <div id="taskTruthTable"></div>
            <p class="task-foot" id="taskTakeaway">Train = sampled trial accuracy. Eval = full gate truth-table accuracy.</p>
          </div>
        </section>

        <section class="card card-modulator hidden" id="modulatorCard">
          <div class="card-header">
            <h2>Neuromodulator Field</h2>
            <div class="header-actions">
              <div class="control-row">
                <label>Field <select id="modulatorFieldSelect"></select></label>
                <label>Kind <select id="modulatorKindSelect"></select></label>
              </div>
              <span class="chip">Mod grid</span>
            </div>
          </div>
          <canvas id="modulatorCanvas"></canvas>
        </section>

        <section class="card card-receptor hidden" id="receptorCard">
          <div class="card-header">
            <h2>Receptor Summary</h2>
            <div class="header-actions">
              <div class="control-row">
                <label>Proj <select id="receptorProjectionSelect"></select></label>
                <label>Metric <select id="receptorMetricSelect"></select></label>
              </div>
              <span class="chip">Receptors</span>
            </div>
          </div>
          <canvas id="receptorCanvas"></canvas>
        </section>

        <section class="card card-vision hidden" id="visionCard">
          <div class="card-header">
            <h2>Vision Input</h2>
            <span class="chip">Frame</span>
          </div>
          <canvas id="visionCanvas"></canvas>
        </section>
      </main>
    </div>

    <script src="app.js"></script>
  </body>
</html>
